@{
    ViewBag.Title = "Cronograma Semanal";
    Layout = "~/Views/Shared/_Layout.cshtml"; 

    Dictionary<DateTime, Dictionary<double, INFO_360.Models.Tarea>> agenda = ViewBag.AGENDA; 
}

<h2 class="text-center mb-4">Cronograma Semanal</h2>

@if (agenda == null || agenda.Count == 0)
{
    <div class="alert alert-warning text-center">
        No hay tareas programadas para los próximos 7 días.
    </div>
}
else
{
    <div class="container">
        @foreach (DateTime dia in agenda.Keys.OrderBy(d => d))
        {
            Dictionary<double, INFO_360.Models.Tarea> tareasDia = agenda[dia];

            <div class="card mb-4 shadow-sm">
                <div class="card-header bg-primary text-white">
                    <h4>@dia.ToString("dddd dd/MM/yyyy")</h4>
                </div>
                <div class="card-body">
                    @if (tareasDia == null || tareasDia.Count == 0)
                    {
                        <p>No hay tareas asignadas para este día.</p>
                    }
                    else
                    {
                        <table class="table table-striped table-bordered">
                            <thead>
                                <tr>
                                    <th>Hora</th>
                                    <th>Tarea</th>
                                    <th>Duración</th>
                                    <th>Descripción</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (double hora in tareasDia.Keys.OrderBy(h => h))
                                {
                                    INFO_360.Models.Tarea t = tareasDia[hora];
                                    if (t != null)
                                    {
                                        <tr>
                                            <td>@String.Format("{0:00.00}", hora)</td>
                                            <td>@t.Titulo</td>
                                            <td>@t.Duracion h</td>
                                            <td>@t.Descripcion</td>
                                        </tr>
                                    }
                                }
                            </tbody>
                        </table>
                    }
                </div>
            </div>
        }
    </div>
}
